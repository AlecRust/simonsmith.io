define("modules/Spinner",["require","jquery","mediator-js"],function(e){function t(e,t){this.container=n(e),this.elem=n("<div></div>",{"class":"loading","aria-hidden":!0}).hide(),this.elem.appendTo(this.container),this.attachEvents(t)}var n=e("jquery"),r=e("mediator-js");return t.prototype={attachEvents:function(e){r.subscribe(e.show,this.show,null,this),r.subscribe(e.hide,this.hide,null,this)},show:function(){this.elem.attr("aria-hidden",!1).show(),this.container.attr("aria-busy",!0)},hide:function(){this.elem.attr("aria-hidden",!0).hide(),this.container.attr("aria-busy",!1)}},t}),define("modules/Scroller",["require","jquery","mediator-js"],function(e){var t=e("jquery"),n=e("mediator-js"),r=function(e){this.attachEvents(e.contentLoad)};return r.prototype={scrollable:t("html, body"),attachEvents:function(e){n.subscribe(e,this.scrollToTop,null,this)},scrollToTop:function(e){"ajax"==e.navType&&this.scrollable.animate({scrollTop:0})}},r}),define("modules/PageUpdater",["require","jquery","handlebars","mediator-js"],function(e){var t=e("jquery"),n=e("handlebars"),r=e("mediator-js"),i=function(e,n,r){this.nav=t(e),this.injectTarget=t(n),this.body=t(document.body),this.attachEvents(r.contentLoad)};return i.prototype={attachEvents:function(e){r.subscribe(e,this.updatePage,null,this)},updatePage:function(e){var n=e.response;n.page_meta.page_title!=t.trim(document.title.split("|")[0])&&(this.updateNavigation(n.page_meta.nav_menu),this.updateBodyClass(n.page_meta.body_class),this.updateTitle(n.page_meta.page_title),"ajax"==e.navType&&this.updateContent(e.element,n),"popstate"==e.navType&&this.renderTemplate(n.template,n))},updateTitle:function(e){var n=document.title.split("|");document.title=[e," | ",t.trim(n[1])].join("")},updateNavigation:function(e){this.nav.html(e)},updateBodyClass:function(e){this.body.removeClass().addClass(e)},updateContent:function(e,t){this.renderTemplate(t.template,t),history.pushState(t,null,e.attr("href"))},renderTemplate:function(e,t){var i=n.templates[e];this.injectTarget.html(i(t)),r.publish("content:rendered",t.page_meta)}},i}),define("modules/PageController",["require","jquery","mediator-js","modules/Spinner","modules/Scroller","modules/PageUpdater"],function(e){function t(e){n.each(e,function(e,t){this[e]=n(t)}.bind(this)),new i(this.container,{show:"content:get:before",hide:"content:get:always"}),new s({contentLoad:"content:get:done"}),new o(this.nav,this.injectTarget,{contentLoad:"content:get:done"}),this.attachEvents()}var n=e("jquery"),r=e("mediator-js"),i=e("modules/Spinner"),s=e("modules/Scroller"),o=e("modules/PageUpdater");return t.prototype={attachEvents:function(){this.container.on("click",this.links.selector,this.getPageContent.bind(this)),window.addEventListener("popstate",function(e){e.state&&r.publish("content:get:done",{response:e.state,navType:"popstate"})}.bind(this))},getPageContent:function(e){var t=n(e.currentTarget),i=n.ajax({data:{ajax:!0},dataType:"json",context:this,timeout:6e3,url:t.attr("href"),beforeSend:function(){r.publish("content:get:before")}});i.always(function(){r.publish("content:get:always")}),i.fail(function(){r.publish("content:get:fail",{element:t})}),i.done(function(e){r.publish("content:get:done",{response:e,navType:"ajax",element:t})}),e&&e.preventDefault()}},t});